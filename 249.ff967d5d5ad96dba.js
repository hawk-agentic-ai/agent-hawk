"use strict";(self.webpackChunkhedge_accounting_sfx=self.webpackChunkhedge_accounting_sfx||[]).push([[249],{2249:(D,r,d)=>{d.r(r),d.d(r,{HedgeBusinessEventsComponent:()=>F});var _=d(467),u=d(177),o=d(4341),v=d(9641),g=d(1570),h=d(1141),e=d(4438),c=d(285),m=d(5779);const p=()=>({width:"100vw",height:"95vh","max-width":"100vw","max-height":"95vh","border-top-left-radius":"16px","border-top-right-radius":"16px"});function E(l,C){if(1&l&&(e.j41(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21),e.EFF(5,"Identifiers"),e.k0s()(),e.j41(6,"div",22)(7,"div")(8,"div",23),e.EFF(9,"Event ID"),e.k0s(),e.j41(10,"div",24),e.EFF(11),e.k0s()(),e.j41(12,"div")(13,"div",23),e.EFF(14,"Instruction ID"),e.k0s(),e.j41(15,"div",25),e.EFF(16),e.k0s()(),e.j41(17,"div")(18,"div",23),e.EFF(19,"Event Type"),e.k0s(),e.j41(20,"div",24),e.EFF(21),e.k0s()(),e.j41(22,"div")(23,"div",23),e.EFF(24,"Event Status"),e.k0s(),e.j41(25,"div",24),e.EFF(26),e.k0s()()()()(),e.j41(27,"div",18)(28,"div",19)(29,"div",20)(30,"div",21),e.EFF(31,"Stage Status"),e.k0s()(),e.j41(32,"div",22)(33,"div")(34,"div",23),e.EFF(35,"Stage 1A Status"),e.k0s(),e.j41(36,"div",24),e.EFF(37),e.k0s()(),e.j41(38,"div")(39,"div",23),e.EFF(40,"Stage 2 Status"),e.k0s(),e.j41(41,"div",24),e.EFF(42),e.k0s()(),e.j41(43,"div")(44,"div",23),e.EFF(45,"Stage 3 Status"),e.k0s(),e.j41(46,"div",24),e.EFF(47),e.k0s()(),e.j41(48,"div")(49,"div",23),e.EFF(50,"Booking Model"),e.k0s(),e.j41(51,"div",24),e.EFF(52),e.k0s()()()()(),e.j41(53,"div",18)(54,"div",19)(55,"div",20)(56,"div",21),e.EFF(57,"Deal Counts"),e.k0s()(),e.j41(58,"div",22)(59,"div")(60,"div",23),e.EFF(61,"Expected Deals"),e.k0s(),e.j41(62,"div",24),e.EFF(63),e.k0s()(),e.j41(64,"div")(65,"div",23),e.EFF(66,"Actual Deals"),e.k0s(),e.j41(67,"div",24),e.EFF(68),e.k0s()()()()(),e.j41(69,"div",18)(70,"div",19)(71,"div",20)(72,"div",21),e.EFF(73,"Timestamps"),e.k0s()(),e.j41(74,"div",22)(75,"div")(76,"div",23),e.EFF(77,"Created Date"),e.k0s(),e.j41(78,"div",24),e.EFF(79),e.k0s()(),e.j41(80,"div")(81,"div",23),e.EFF(82,"Updated Date"),e.k0s(),e.j41(83,"div",24),e.EFF(84),e.k0s()(),e.j41(85,"div")(86,"div",23),e.EFF(87,"Created By"),e.k0s(),e.j41(88,"div",24),e.EFF(89),e.k0s()(),e.j41(90,"div")(91,"div",23),e.EFF(92,"Updated By"),e.k0s(),e.j41(93,"div",24),e.EFF(94),e.k0s()()()()()()),2&l){const n=e.XpG();e.R7$(11),e.JRh(n.selected.event_id),e.R7$(5),e.JRh(n.selected.instruction_id),e.R7$(5),e.JRh(n.selected.event_type),e.R7$(5),e.JRh(n.selected.event_status),e.R7$(11),e.JRh(n.selected.stage_1a_status),e.R7$(5),e.JRh(n.selected.stage_2_status),e.R7$(5),e.JRh(n.selected.stage_3_status),e.R7$(5),e.JRh(n.selected.assigned_booking_model),e.R7$(11),e.JRh(n.selected.expected_deal_count),e.R7$(5),e.JRh(n.selected.actual_deal_count),e.R7$(11),e.JRh(n.selected.created_date),e.R7$(5),e.JRh(n.selected.updated_date),e.R7$(5),e.JRh(n.selected.created_by),e.R7$(5),e.JRh(n.selected.updated_by)}}function f(l,C){if(1&l){const n=e.RV6();e.j41(0,"div",26)(1,"button",27),e.bIt("click",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.showDialog=!1)}),e.EFF(2,"Close"),e.k0s()()}}let F=(()=>{class l{constructor(n){this.hedgeBusinessEventsService=n,this.events=[],this.search="",this.status=null,this.fromDate=null,this.toDate=null,this.showDialog=!1,this.selected=null,this.columnDefs=[{headerName:"Event ID",field:"event_id",minWidth:120,flex:1,pinned:"left"},{headerName:"Instruction ID",field:"instruction_id",minWidth:140,flex:1},{headerName:"Event Type",field:"event_type",minWidth:100,flex:1},{headerName:"Event Status",field:"event_status",minWidth:100,flex:1,cellRenderer:s=>{const t=s.value;return`<span class="font-medium ${"Completed"===t?"text-green-600":"Failed"===t?"text-red-600":"Active"===t?"text-blue-600":"text-gray-600"}">${t||""}</span>`}},{headerName:"Stage 1A Status",field:"stage_1a_status",minWidth:110,flex:1,cellRenderer:s=>this.renderStageStatus(s.value)},{headerName:"Stage 2 Status",field:"stage_2_status",minWidth:100,flex:1,cellRenderer:s=>this.renderStageStatus(s.value)},{headerName:"Stage 3 Status",field:"stage_3_status",minWidth:100,flex:1,cellRenderer:s=>this.renderStageStatus(s.value)},{headerName:"Booking Model",field:"assigned_booking_model",minWidth:110,flex:1},{headerName:"Expected Deals",field:"expected_deal_count",minWidth:110,flex:1,type:"numericColumn"},{headerName:"Actual Deals",field:"actual_deal_count",minWidth:100,flex:1,type:"numericColumn",cellRenderer:s=>{const t=s.value||0;return`<span class="${t===(s.data?.expected_deal_count||0)&&t>0?"text-green-600":t>0?"text-orange-600":"text-gray-400"}">${t}</span>`}},{headerName:"Created Date",field:"created_date",minWidth:140,flex:1,cellRenderer:s=>s.value?new Date(s.value).toLocaleString():""},{headerName:"Updated Date",field:"updated_date",minWidth:140,flex:1,cellRenderer:s=>s.value?new Date(s.value).toLocaleString():""},{headerName:"Actions",width:80,pinned:"right",suppressSizeToFit:!0,cellRenderer:s=>{const t=document.createElement("button");return t.className="text-gray-500 hover:text-blue-600 p-1",t.title="View Details",t.innerHTML='<i class="pi pi-eye"></i>',t.addEventListener("click",()=>s.context.componentParent.viewRow(s.data)),t}}],this.defaultColDef={resizable:!0,sortable:!0,filter:"agSetColumnFilter"},this.gridOptions={pagination:!0,paginationPageSize:25,animateRows:!0,context:{componentParent:this}}}ngOnInit(){this.load(),this.hedgeBusinessEventsService.subscribeRealtime(()=>this.load())}load(){var n=this;return(0,_.A)(function*(){n.events=yield n.hedgeBusinessEventsService.list({search:n.search||void 0,status:n.status||void 0,fromDate:n.fromDate||void 0,toDate:n.toDate||void 0})})()}onGridReady(n){this.gridApi=n.api}viewRow(n){this.selected=n,this.showDialog=!0}renderStageStatus(n){return n?`<span class="${"Completed"===n?"text-green-600":"In_Progress"===n?"text-blue-600":"Failed"===n?"text-red-600":"Pending"===n?"text-gray-600":"text-gray-400"}">${n}</span>`:""}static{this.\u0275fac=function(s){return new(s||l)(e.rXU(c.M))}}static{this.\u0275cmp=e.VBU({type:l,selectors:[["app-operations-hedge-business-events"]],standalone:!0,features:[e.aNF],decls:39,vars:15,consts:[[1,"p-6","h-full","flex","flex-col"],[1,"mb-6"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"filter-bar"],[1,"filter-row","w-full"],[1,"flex","items-center","space-x-2"],[1,"filter-label"],["placeholder","event_id, instruction_id, event_type...",1,"filter-input","w-72",3,"ngModelChange","ngModel"],[1,"filter-input","w-48",3,"ngModelChange","ngModel"],[3,"ngValue"],["type","date",1,"filter-input",3,"ngModelChange","ngModel"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200",2,"height","calc(100vh - 300px)","min-height","400px"],[1,"ag-theme-alpine",2,"width","100%","height","100%",3,"gridReady","columnDefs","rowData","defaultColDef","gridOptions"],["header","Event Details","styleClass","entity-dialog entity-dialog-full",3,"visibleChange","visible","modal"],["class","space-y-4 p-2",4,"ngIf"],["pTemplate","footer"],[1,"space-y-4","p-2"],[1,"rounded-lg","border","border-gray-200","p-4","bg-white"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","md:col-span-3"],[1,"text-sm","font-semibold","text-gray-700"],[1,"col-span-12","md:col-span-9","grid","grid-cols-1","md:grid-cols-2","gap-3","text-sm"],[1,"text-gray-500"],[1,"font-medium"],[1,"font-mono"],[1,"flex","justify-end","space-x-3","pt-4","border-t","border-gray-200"],[1,"btn","btn-secondary",3,"click"]],template:function(s,t){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Hedge Business Events"),e.k0s(),e.j41(4,"p",3),e.EFF(5,"Live from hedge_business_events (Supabase)"),e.k0s()(),e.j41(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),e.EFF(10,"Search:"),e.k0s(),e.j41(11,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(t.search,i)||(t.search=i),i}),e.bIt("ngModelChange",function(){return t.load()}),e.k0s()(),e.j41(12,"div",6)(13,"label",7),e.EFF(14,"Event Status:"),e.k0s(),e.j41(15,"select",9),e.mxI("ngModelChange",function(i){return e.DH7(t.status,i)||(t.status=i),i}),e.bIt("ngModelChange",function(){return t.load()}),e.j41(16,"option",10),e.EFF(17,"All"),e.k0s(),e.j41(18,"option"),e.EFF(19,"Active"),e.k0s(),e.j41(20,"option"),e.EFF(21,"Completed"),e.k0s(),e.j41(22,"option"),e.EFF(23,"Failed"),e.k0s(),e.j41(24,"option"),e.EFF(25,"Cancelled"),e.k0s()()(),e.j41(26,"div",6)(27,"label",7),e.EFF(28,"From:"),e.k0s(),e.j41(29,"input",11),e.mxI("ngModelChange",function(i){return e.DH7(t.fromDate,i)||(t.fromDate=i),i}),e.bIt("ngModelChange",function(){return t.load()}),e.k0s()(),e.j41(30,"div",6)(31,"label",7),e.EFF(32,"To:"),e.k0s(),e.j41(33,"input",11),e.mxI("ngModelChange",function(i){return e.DH7(t.toDate,i)||(t.toDate=i),i}),e.bIt("ngModelChange",function(){return t.load()}),e.k0s()()()(),e.j41(34,"div",12)(35,"ag-grid-angular",13),e.bIt("gridReady",function(i){return t.onGridReady(i)}),e.k0s()(),e.j41(36,"p-dialog",14),e.mxI("visibleChange",function(i){return e.DH7(t.showDialog,i)||(t.showDialog=i),i}),e.DNE(37,E,95,14,"div",15)(38,f,3,0,"ng-template",16),e.k0s()()),2&s&&(e.R7$(11),e.R50("ngModel",t.search),e.R7$(4),e.R50("ngModel",t.status),e.R7$(),e.Y8G("ngValue",null),e.R7$(13),e.R50("ngModel",t.fromDate),e.R7$(4),e.R50("ngModel",t.toDate),e.R7$(2),e.Y8G("columnDefs",t.columnDefs)("rowData",t.events)("defaultColDef",t.defaultColDef)("gridOptions",t.gridOptions),e.R7$(),e.Aen(e.lJ4(14,p)),e.R50("visible",t.showDialog),e.Y8G("modal",!0),e.R7$(),e.Y8G("ngIf",t.selected))},dependencies:[u.MD,u.bT,o.YN,o.xH,o.y7,o.me,o.wz,o.BC,o.vS,v.xs,g.P,g.l,m.Ei,h.tm],encapsulation:2})}}return l})()}}]);