"use strict";(self.webpackChunkhedge_accounting_sfx=self.webpackChunkhedge_accounting_sfx||[]).push([[141],{3141:(j,g,r)=>{r.r(g),r.d(g,{PromptTemplatesComponent:()=>S});var m=r(467),c=r(177),y=r(1141),_=r(2242),h=r(8833),f=r(1570),e=r(4438);let T=(()=>{class o{static \u0275fac=function(a){return new(a||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[c.MD]})}return o})();var p=r(4341),v=r(9641),b=r(4885),C=r(5779);const F=()=>({width:"100vw",height:"90vh","border-top-left-radius":"16px","border-top-right-radius":"16px","max-width":"100vw","max-height":"90vh"}),u=()=>({width:"100%"}),M=()=>({label:"Active",value:"active"}),x=()=>({label:"Inactive",value:"inactive"}),E=(o,d)=>[o,d];function w(o,d){if(1&o){const n=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){const t=e.eBV(n).$implicit,l=e.XpG();return e.Njj(l.onFamilyTabChange(t.value))}),e.EFF(1),e.k0s()}if(2&o){const n=d.$implicit,a=e.XpG();e.AVh("bg-blue-600",a.selectedFamilyType===n.value)("text-white",a.selectedFamilyType===n.value)("border-blue-600",a.selectedFamilyType===n.value)("bg-white",a.selectedFamilyType!==n.value)("text-gray-700",a.selectedFamilyType!==n.value)("border-gray-300",a.selectedFamilyType!==n.value),e.R7$(),e.JRh(n.label)}}function R(o,d){if(1&o){const n=e.RV6();e.j41(0,"div",40)(1,"button",41),e.bIt("click",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.showSheet=!1)}),e.EFF(2,"Cancel"),e.k0s(),e.j41(3,"button",42),e.bIt("click",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.confirmSave())}),e.EFF(4),e.k0s()()}if(2&o){const n=e.XpG();e.R7$(4),e.JRh("edit"===n.mode?"Update Template":"Save Template")}}let S=(()=>{class o{constructor(n,a){this.ngZone=n,this.promptTemplatesService=a,this.defaultColDef={resizable:!0,sortable:!0,filter:"agSetColumnFilter",minWidth:100},this.templates=[],this.filteredTemplates=[],this.search="",this.selectedFamilyType="",this.showSheet=!1,this.mode="add",this.form={},this.placeholderText="Enter your prompt template here...\n\n TEMPLATE PATTERN: Use {{field_name}} for input fields\n\n RECOMMENDED EXAMPLES:\n\nRisk Management:\nCalculate VaR for {{portfolio_name}} with {{confidence_level}}% confidence over {{time_horizon}} days using {{methodology}} method.\n\nHedge Analysis:\nAnalyze {{hedge_type}} effectiveness for {{entity}} covering {{currency}} exposure of {{amount}} from {{start_date}} to {{end_date}}.\n\nCompliance Check:\nReview {{regulation_type}} compliance for {{business_line}} with threshold {{threshold_amount}} in {{base_currency}}.\n\n FIELD NAMING BEST PRACTICES:\n Use lowercase with underscores: {{field_name}}\n Common fields: {{entity}}, {{currency}}, {{amount}}, {{date}}\n Descriptive names: {{start_date}}, {{end_date}}, {{risk_type}}\n\n FIELD TYPES SUPPORTED:\n Text: {{entity}}, {{currency}}, {{description}}\n Numbers: {{amount}}, {{rate}}, {{percentage}}  \n Dates: {{date}}, {{maturity_date}}\n\nInput fields will be automatically created from {{field_name}} patterns.",this.familyTypeOptions=[],this.templateCategoryOptions=[],this.columnDefs=[{field:"family_type",headerName:"Family Type",width:160,sortable:!0},{field:"template_category",headerName:"Category",width:160,sortable:!0},{field:"name",headerName:"Template Name",width:220,sortable:!0},{field:"prompt_text",headerName:"Prompt Text",flex:1,sortable:!0},{field:"usage_count",headerName:"Usage",width:100,sortable:!0,cellClass:"text-center"},{field:"status",headerName:"Status",width:100,cellRenderer:t=>{const l="active"===t.value?"Active":"Inactive",i="Active"===l?"bg-green-100 text-green-800":"bg-red-100 text-red-800",s=document.createElement("span");return s.className=`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i}`,s.textContent=l,s}},{field:"created_at",headerName:"Created",width:140,sortable:!0},{field:"updated_at",headerName:"Updated",width:140,sortable:!0},{headerName:"Actions",width:120,pinned:"right",cellRenderer:t=>{const l=document.createElement("div");l.className="flex items-center justify-center space-x-2";const i=document.createElement("button");i.className="text-gray-500 hover:text-blue-600 p-1",i.title="Edit Template",i.innerHTML='<i class="pi pi-pencil text-sm"></i>',i.addEventListener("click",()=>t.context.componentParent.editRow(t.data));const s=document.createElement("button");return s.className="text-gray-500 hover:text-red-600 p-1",s.title="Delete Template",s.innerHTML='<i class="pi pi-trash text-sm"></i>',s.addEventListener("click",()=>t.context.componentParent.deleteRow(t.data)),l.appendChild(i),l.appendChild(s),l}}],this.gridOptions={pagination:!0,paginationPageSize:20,animateRows:!0,context:{componentParent:this}}}ngOnInit(){var n=this;return(0,m.A)(function*(){n.familyTypeOptions=[{label:"All Types",value:""}],n.selectedFamilyType="",n.templateSub=n.promptTemplatesService.templates$.subscribe(a=>{n.templates=a,n.applyFilters(),setTimeout(()=>n.gridApi?.sizeColumnsToFit(),0)}),n.loadFamilyTypes().catch(a=>{console.error("Failed to load family types:",a)})})()}loadFamilyTypes(){var n=this;return(0,m.A)(function*(){try{const a=yield n.promptTemplatesService.getUniqueFamilyTypes();n.familyTypeOptions=[{label:"All Types",value:""},...a]}catch(a){console.error("Error loading family types:",a),n.familyTypeOptions=[{label:"All Types",value:""},{label:"Hedge Accounting",value:"hedge_accounting"},{label:"Risk Management",value:"risk_management"},{label:"Compliance",value:"compliance"}]}})()}onFamilyTypeChange(n){var a=this;return(0,m.A)(function*(){const t=n.value;if(t)try{a.templateCategoryOptions=yield a.promptTemplatesService.getTemplateCategoriesByFamily(t),a.form.template_category=""}catch(l){console.error("Error loading template categories:",l),a.templateCategoryOptions=[]}else a.templateCategoryOptions=[],a.form.template_category=""})()}ngOnDestroy(){this.templateSub&&this.templateSub.unsubscribe()}onGridReady(n){this.gridApi=n.api,n.api.sizeColumnsToFit(),this.applyFilters()}onSearchChange(n){this.search=n,this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>this.applyFilters(),300)}onFilterChange(){this.applyFilters()}onFamilyTabChange(n){this.selectedFamilyType=n,this.applyFilters()}applyFilters(){let n=this.templates;if(this.search.trim()){const a=this.search.trim().toLowerCase();n=n.filter(t=>t.name?.toLowerCase().includes(a)||t.prompt_text?.toLowerCase().includes(a)||t.family_type?.toLowerCase().includes(a)||t.template_category?.toLowerCase().includes(a))}this.selectedFamilyType&&""!==this.selectedFamilyType&&(n=n.filter(a=>a.family_type===this.selectedFamilyType)),this.filteredTemplates=n,setTimeout(()=>this.gridApi?.sizeColumnsToFit(),0)}openAdd(){this.mode="add",this.form={status:"active",usage_count:0,display_order:1},this.ngZone.run(()=>this.showSheet=!0)}editRow(n){var a=this;return(0,m.A)(function*(){if(a.mode="edit",a.form={...n},n.family_type)try{a.templateCategoryOptions=yield a.promptTemplatesService.getTemplateCategoriesByFamily(n.family_type)}catch(t){console.error("Error loading template categories for edit:",t)}a.ngZone.run(()=>a.showSheet=!0)})()}deleteRow(n){confirm("Are you sure you want to delete this template?")&&this.promptTemplatesService.deleteTemplate(n.id)}confirmSave(){var n=this;return(0,m.A)(function*(){"edit"===n.mode&&n.form.id?yield n.promptTemplatesService.updateTemplate(n.form.id,n.form):yield n.promptTemplatesService.addTemplate(n.form),n.showSheet=!1,n.mode="add",n.form={}})()}static{this.\u0275fac=function(a){return new(a||o)(e.rXU(e.SKi),e.rXU(b.r))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-prompt-templates"]],standalone:!0,features:[e.aNF],decls:92,vars:46,consts:[[1,"p-6"],[1,"mb-6"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"mb-3","overflow-x-auto"],[1,"flex","gap-2"],["class","px-3 py-1.5 rounded-full border text-sm whitespace-nowrap",3,"bg-blue-600","text-white","border-blue-600","bg-white","text-gray-700","border-gray-300","click",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-4","mb-4"],[1,"flex-1","flex","items-center","gap-2"],[1,"filter-label"],["type","text","placeholder","Search templates...",1,"filter-input","flex-1","max-w-xs",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","ml-auto",3,"click"],[1,"pi","pi-plus"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"ag-theme-alpine","w-full",2,"height","600px",3,"gridReady","columnDefs","rowData","defaultColDef","gridOptions"],["styleClass","entity-dialog entity-dialog-full",3,"visibleChange","header","visible","modal","closable"],[1,"space-y-6","p-2"],[1,"rounded-lg","border","border-gray-200","p-4","bg-white"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","md:col-span-3","flex","items-center"],[1,"text-sm","font-semibold","text-gray-700"],[1,"col-span-12","md:col-span-9"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"field"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","name","name","placeholder","Enter template name",1,"filter-input","w-full",3,"ngModelChange","ngModel"],["name","family_type","placeholder","Select family type","optionLabel","label","optionValue","value","styleClass","filter-input",1,"w-full",3,"ngModelChange","onChange","options","ngModel"],["name","template_category","placeholder","Select category","optionLabel","label","optionValue","value","styleClass","filter-input",1,"w-full",3,"ngModelChange","options","ngModel","disabled"],["name","status","placeholder","Select status","optionLabel","label","optionValue","value","styleClass","filter-input",1,"w-full",3,"ngModelChange","options","ngModel"],[1,"col-span-12","md:col-span-3","flex","items-start"],[1,"space-y-4"],["rows","3","name","description","placeholder","Enter template description",1,"filter-input","w-full",3,"ngModelChange","ngModel"],[1,"text-xs","text-gray-500","mb-2"],["rows","8","name","prompt_text",1,"filter-input","w-full","font-mono","text-sm",3,"ngModelChange","ngModel","placeholder"],[1,"text-xs","text-gray-500","mt-1"],["type","text","name","template_filters","placeholder","Enter comma-separated filters (e.g., hedge, swap, options)",1,"filter-input","w-full",3,"ngModelChange","ngModel"],["type","number","name","display_order","placeholder","Enter display order",1,"filter-input","w-full",3,"ngModelChange","ngModel"],["type","number","name","usage_count","readonly","",1,"filter-input","w-full",3,"ngModelChange","ngModel"],["pTemplate","footer"],[1,"px-3","py-1.5","rounded-full","border","text-sm","whitespace-nowrap",3,"click"],[1,"flex","justify-end","space-x-3","pt-4","border-t","border-gray-200"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(a,t){1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Prompt Templates Configuration"),e.k0s(),e.j41(4,"p",3),e.EFF(5,"Manage and configure prompt templates for HAWK Agent Template Mode"),e.k0s()(),e.j41(6,"div",4)(7,"div",5),e.DNE(8,w,2,13,"button",6),e.k0s()(),e.j41(9,"div",7)(10,"div",8)(11,"label",9),e.EFF(12,"Search:"),e.k0s(),e.j41(13,"input",10),e.mxI("ngModelChange",function(i){return e.DH7(t.search,i)||(t.search=i),i}),e.bIt("ngModelChange",function(i){return t.onSearchChange(i)}),e.k0s()(),e.j41(14,"button",11),e.bIt("click",function(){return t.openAdd()}),e.nrm(15,"i",12),e.j41(16,"span"),e.EFF(17,"Add Template"),e.k0s()()(),e.j41(18,"div",13)(19,"ag-grid-angular",14),e.bIt("gridReady",function(i){return t.onGridReady(i)}),e.k0s()(),e.j41(20,"p-dialog",15),e.mxI("visibleChange",function(i){return e.DH7(t.showSheet,i)||(t.showSheet=i),i}),e.j41(21,"form",16)(22,"div",17)(23,"div",18)(24,"div",19)(25,"div",20),e.EFF(26,"Basic Information"),e.k0s()(),e.j41(27,"div",21)(28,"div",22)(29,"div",23)(30,"label",24),e.EFF(31,"Template Name"),e.k0s(),e.j41(32,"input",25),e.mxI("ngModelChange",function(i){return e.DH7(t.form.name,i)||(t.form.name=i),i}),e.k0s()(),e.j41(33,"div",23)(34,"label",24),e.EFF(35,"Family Type"),e.k0s(),e.j41(36,"p-dropdown",26),e.mxI("ngModelChange",function(i){return e.DH7(t.form.family_type,i)||(t.form.family_type=i),i}),e.bIt("onChange",function(i){return t.onFamilyTypeChange(i)}),e.k0s()(),e.j41(37,"div",23)(38,"label",24),e.EFF(39,"Template Category"),e.k0s(),e.j41(40,"p-dropdown",27),e.mxI("ngModelChange",function(i){return e.DH7(t.form.template_category,i)||(t.form.template_category=i),i}),e.k0s()(),e.j41(41,"div",23)(42,"label",24),e.EFF(43,"Status"),e.k0s(),e.j41(44,"p-dropdown",28),e.mxI("ngModelChange",function(i){return e.DH7(t.form.status,i)||(t.form.status=i),i}),e.k0s()()()()()(),e.j41(45,"div",17)(46,"div",18)(47,"div",29)(48,"div",20),e.EFF(49,"Template Content"),e.k0s()(),e.j41(50,"div",21)(51,"div",30)(52,"div",23)(53,"label",24),e.EFF(54,"Description"),e.k0s(),e.j41(55,"textarea",31),e.mxI("ngModelChange",function(i){return e.DH7(t.form.description,i)||(t.form.description=i),i}),e.k0s()(),e.j41(56,"div",23)(57,"label",24),e.EFF(58,"Prompt Text"),e.k0s(),e.j41(59,"div",32),e.EFF(60),e.k0s(),e.j41(61,"textarea",33),e.mxI("ngModelChange",function(i){return e.DH7(t.form.prompt_text,i)||(t.form.prompt_text=i),i}),e.k0s(),e.j41(62,"div",34)(63,"strong"),e.EFF(64,"Example:"),e.k0s(),e.nrm(65,"br"),e.EFF(66),e.nrm(67,"br"),e.j41(68,"em"),e.EFF(69,"This will create input fields for: transaction_type, entity_name, amount, and currency"),e.k0s()()(),e.j41(70,"div",23)(71,"label",24),e.EFF(72,"Template Filters"),e.k0s(),e.j41(73,"input",35),e.mxI("ngModelChange",function(i){return e.DH7(t.form.template_filters,i)||(t.form.template_filters=i),i}),e.k0s(),e.j41(74,"div",34),e.EFF(75,"Add filters to help users find this template easily"),e.k0s()()()()()(),e.j41(76,"div",17)(77,"div",18)(78,"div",19)(79,"div",20),e.EFF(80,"Metadata"),e.k0s()(),e.j41(81,"div",21)(82,"div",22)(83,"div",23)(84,"label",24),e.EFF(85,"Display Order"),e.k0s(),e.j41(86,"input",36),e.mxI("ngModelChange",function(i){return e.DH7(t.form.display_order,i)||(t.form.display_order=i),i}),e.k0s()(),e.j41(87,"div",23)(88,"label",24),e.EFF(89,"Usage Count"),e.k0s(),e.j41(90,"input",37),e.mxI("ngModelChange",function(i){return e.DH7(t.form.usage_count,i)||(t.form.usage_count=i),i}),e.k0s()()()()()()(),e.DNE(91,R,5,1,"ng-template",38),e.k0s()()),2&a&&(e.R7$(8),e.Y8G("ngForOf",t.familyTypeOptions),e.R7$(5),e.R50("ngModel",t.search),e.R7$(6),e.Y8G("columnDefs",t.columnDefs)("rowData",t.filteredTemplates)("defaultColDef",t.defaultColDef)("gridOptions",t.gridOptions),e.R7$(),e.Aen(e.lJ4(37,F)),e.FS9("header","edit"===t.mode?"Edit Template":"Add Template"),e.R50("visible",t.showSheet),e.Y8G("modal",!0)("closable",!0),e.R7$(12),e.R50("ngModel",t.form.name),e.R7$(4),e.Aen(e.lJ4(38,u)),e.Y8G("options",t.familyTypeOptions),e.R50("ngModel",t.form.family_type),e.R7$(4),e.Aen(e.lJ4(39,u)),e.Y8G("options",t.templateCategoryOptions),e.R50("ngModel",t.form.template_category),e.Y8G("disabled",!t.form.family_type),e.R7$(4),e.Aen(e.lJ4(40,u)),e.Y8G("options",e.l_i(43,E,e.lJ4(41,M),e.lJ4(42,x))),e.R50("ngModel",t.form.status),e.R7$(11),e.R50("ngModel",t.form.description),e.R7$(5),e.SpI("Use ","{{input_field_name}}"," to create dynamic input fields for users"),e.R7$(),e.R50("ngModel",t.form.prompt_text),e.Y8G("placeholder",t.placeholderText),e.R7$(5),e.LHq(" Analyze the ","{{transaction_type}}"," for ","{{entity_name}}"," with amount ","{{amount}}"," in ","{{currency}}",""),e.R7$(7),e.R50("ngModel",t.form.template_filters),e.R7$(13),e.R50("ngModel",t.form.display_order),e.R7$(4),e.R50("ngModel",t.form.usage_count))},dependencies:[c.MD,c.Sq,y.tm,C.Ei,v.xs,_.u,h.kr,h.ms,f.P,f.l,T,p.YN,p.qT,p.me,p.Q0,p.BC,p.cb,p.vS,p.cV],encapsulation:2})}}return o})()}}]);